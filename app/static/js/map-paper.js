function getPoint(e){var n=155;return new Point((parseFloat(e.longitude)+107)*n*.8,(parseFloat(e.latitude)-37)*-n)}function drawCities(e){var n=e.locations;for(i in n){var t=n[i];t.point=getPoint(t);var o=(new Path.Circle({center:t.point,radius:5,fillColor:"black"}),new PointText(t.point));o.justification="center",o.fillColor="red",o.content=t.name}for(i=0;i<e.connections.length;i++){var a=e.connections[i],r=new Path;r.strokeColor="black",r.moveTo(n[a.city1].point),r.lineTo(n[a.city2].point)}mapLayer.position=new Point(240,150)}function changeZoom(e,n,t,i){var o=1.05,a=e;return n>0&&(a*=o),n<0&&(a/=o),a}function changeCenter(e,n,t,i){var o;return o=new Point(n,(-t)),o=o.multiply(i),e.add(o)}function onMouseDrag(e){mapLayer.position+=e.delta}var myData,mapObj={},mapLayer=new Layer,i;$("#mapCanvas").bind("mousewheel",function(e){var n=e.originalEvent.wheelDeltaX,t=e.originalEvent.wheelDeltaY;if(e.shiftKey)view.center=changeCenter(view.center,n,t,1),e.preventDefault();else if(e.altKey){var i=new Point(e.offsetX,e.offsetY),o=changeZoom(view.zoom,t,view.center,i);view.zoom=o,e.preventDefault()}}),$.get("/map",function(e){drawCities(e)});